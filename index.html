<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA Draft and Season Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Import Inter font from Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif; /* Apply Inter font to the body */
            overflow-x: hidden; /* Prevent horizontal scroll */
            background-color: #F8FAFC; /* Tailwind gray-100 - mostly white */
            color: #1F2937; /* Tailwind gray-800 - dark text */
        }
        /* Confetti animation styles */
        .confetti {
            position: absolute;
            width: 10px;
            height: 20px;
            opacity: 1;
            transform: rotate(0deg);
            animation: fall 5s linear forwards; /* Default animation, will be overridden by JS */
            border-radius: 2px; /* Small rounded corners for confetti */
        }
        /* Base fall animation keyframes */
        @keyframes fall {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        /* Style for disabled buttons within player cards */
        .player-card-button:disabled {
            background-color: #9CA3AF !important; /* Tailwind gray-400 */
            cursor: not-allowed !important;
            pointer-events: none; /* Disable interaction entirely */
            color: #D1D5DB !important; /* Tailwind gray-300 text for disabled buttons */
        }

        /* Custom Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s, opacity 0.3s ease-in-out;
        }
        .modal-overlay.show {
            visibility: visible;
            opacity: 1;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 90%;
            width: 400px;
            transform: translateY(-20px);
            transition: transform 0.3s ease-in-out;
            color: #1F2937; /* Dark text for modal content */
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0);
        }
        .modal-content h3 {
            font-weight: 700;
            font-size: 1.5rem; /* text-2xl */
            margin-bottom: 1rem;
            color: #DC2626; /* Tailwind red-600 */
        }
        .modal-content p {
            margin-bottom: 1.5rem;
            font-size: 1rem;
            color: #374151; /* Tailwind gray-700 */
        }
        .modal-content button {
            background-color: #2563EB; /* Tailwind blue-600 */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s ease-in-out;
        }
        .modal-content button:hover {
            background-color: #1D4ED8; /* Tailwind blue-700 */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-900">
    <!-- Custom Modal for Messages -->
    <div id="custom-modal" class="modal-overlay">
        <div class="modal-content">
            <h3 id="modal-title"></h3>
            <p id="modal-message"></p>
            <button id="modal-close-btn">OK</button>
        </div>
    </div>

    <!-- Start Screen -->
    <div id="start-screen" class="flex flex-col justify-center items-center h-screen bg-gradient-to-br from-blue-700 to-red-600 text-white">
        <h1 class="text-4xl font-bold text-white mb-8">NBA Draft & Season Simulator</h1>
        <button id="start-btn" class="bg-white hover:bg-gray-200 text-blue-800 font-bold py-3 px-6 rounded-lg text-xl transition duration-300 shadow-lg hover:shadow-xl">Start Game</button>
    </div>

    <!-- Team Selection Screen (hidden initially) -->
    <div id="team-selection-screen" class="hidden flex flex-col justify-center items-center min-h-screen bg-gray-100 p-4">
        <h2 class="text-3xl font-bold text-blue-700 mb-8 text-center">Choose Your Team</h2>
        <div id="team-logos-container" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 gap-4 sm:gap-6 max-w-6xl w-full">
            <!-- Team logos will be injected here by JavaScript -->
        </div>
    </div>

    <!-- Game Container (hidden initially) -->
    <div id="game-container" class="hidden">
        <div id="confetti-container" class="absolute top-0 left-0 w-full h-full pointer-events-none z-50 overflow-hidden"></div>
        <div class="container mx-auto p-4 bg-white rounded-lg shadow-2xl my-8">
            <h1 id="draft-header" class="text-4xl font-bold text-blue-700 text-center mb-8">Draft Point Guard</h1>
            <div id="draft-section" class="grid grid-cols-1 md:grid-cols-5 gap-8">
                <div class="md:col-span-3">
                    <h2 class="text-2xl font-semibold mb-4 text-blue-600">Player Pool: <span id="player-count">0</span> <span id="position-label">Point Guards</span> Available</h2>
                    <div id="player-pool" class="bg-gray-200 rounded-lg p-4 h-96 overflow-y-auto shadow-inner"></div>
                </div>
                <div class="md:col-span-2">
                    <h2 class="text-2xl font-semibold mb-4 text-blue-600">Your Team: <span id="your-team-name" class="text-red-600"></span> (<span id="team-count">0</span>/5)</h2>
                    <p class="text-lg font-semibold mb-4 text-blue-600">Cap Space Remaining: $<span id="cap-space">178</span>M</p>
                    <div id="your-team" class="bg-gray-200 rounded-lg p-4 min-h-[24rem] shadow-inner"></div>
                </div>
            </div>
            <!-- New section for Bot Drafted Players -->
            <div id="bot-drafted-section" class="mt-8">
                <h2 id="bot-drafted-header" class="text-2xl font-semibold mb-4 text-blue-600">Other Teams' Drafted Players</h2>
                <div id="bot-drafted-players" class="bg-gray-200 rounded-lg p-4 h-48 overflow-y-auto shadow-inner grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Bot drafted players will be injected here -->
                </div>
            </div>
            <div id="controls" class="text-center mt-8">
                <button id="sim-season-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg text-lg transition duration-300 disabled:bg-gray-400 disabled:cursor-not-allowed shadow-md hover:shadow-lg">Simulate Season</button>
                <button id="sim-playoffs-btn" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg text-lg transition duration-300 ml-4 disabled:bg-gray-400 shadow-md hover:shadow-lg" style="display: none;">Simulate Playoffs</button>
                <button id="reset-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg text-lg transition duration-300 ml-4 shadow-md hover:shadow-lg" style="display: none;">Draft Again</button>
            </div>
            <div id="results-section" class="text-center mt-8">
                <h2 class="text-2xl font-semibold mb-4 text-blue-600">Results</h2>
                <div id="results-display" class="bg-gray-200 rounded-lg p-4 min-h-[100px] text-lg shadow-inner text-gray-800">
                    Draft your 5-player team to begin!
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Constants for game logic
            const PLAYOFF_WIN_THRESHOLD = 40; // Minimum wins to make playoffs
            const TEAM_SIZE = 5; // Number of players required for a full team
            const NUM_BOT_TEAMS = 10; // Number of bot teams to simulate drafting
            const STARTING_CAP_SPACE = 178; // in millions USD
            // Draft order by position
            const DRAFT_ORDER = [
                { position: "PG", label: "Point Guards" },
                { position: "SG", label: "Shooting Guards" },
                { position: "SF", label: "Small Forwards" },
                { position: "PF", label: "Power Forwards" },
                { position: "C", label: "Centers" }
            ];

            // Player data with name, rating, and position
            let players = [
                { name: "Nikola Jokic", rating: 98, position: "C" },
                { name: "Luka Dončić", rating: 97, position: "PG" },
                { name: "Giannis Antetokounmpo", rating: 96, position: "PF" },
                { name: "Shai Gilgeous-Alexander", rating: 95, position: "SG" },
                { name: "Joel Embiid", rating: 95, position: "C" },
                { name: "Stephen Curry", rating: 94, position: "PG" },
                { name: "Kevin Durant", rating: 94, position: "SF" },
                { name: "Jayson Tatum", rating: 93, position: "SF" },
                { name: "LeBron James", rating: 93, position: "SF" },
                { name: "Anthony Davis", rating: 92, position: "PF/C" },
                { name: "Devin Booker", rating: 92, position: "SG" },
                { name: "Victor Wembanyama", rating: 91, position: "C" },
                { name: "Anthony Edwards", rating: 91, position: "SG" },
                { name: "Damian Lillard", rating: 90, position: "PG" },
                { name: "Donovan Mitchell", rating: 90, position: "SG" },
                { name: "Tyrese Haliburton", rating: 89, position: "PG" },
                { name: "Zion Williamson", rating: 89, position: "PF" },
                { name: "Jamal Murray", rating: 88, position: "SG" },
                { name: "De'Aaron Fox", rating: 88, position: "PG" },
                { name: "Kyrie Irving", rating: 88, position: "PG" },
                { name: "Jimmy Butler", rating: 88, position: "SF" },
                { name: "Tyrese Maxey", rating: 87, position: "PG" },
                { name: "Paul George", rating: 87, position: "SF" },
                { name: "Kawhi Leonard", rating: 87, position: "SF" },
                { name: "LaMelo Ball", rating: 87, position: "PG" },
                { name: "Trae Young", rating: 86, position: "PG" },
                { name: "Bam Adebayo", rating: 86, position: "C" },
                { name: "Jaylen Brown", rating: 86, position: "SG/SF" },
                { name: "Jalen Brunson", rating: 85, position: "PG" },
                { name: "Domantas Sabonis", rating: 85, position: "PF/C" },
                { name: "Pascal Siakam", rating: 85, position: "PF" },
                { name: "Karl-Anthony Towns", rating: 85, position: "C" },
                { name: "Dejounte Murray", rating: 84, position: "SG" },
                { name: "Lauri Markkanen", rating: 84, position: "PF" },
                { name: "Chet Holmgren", rating: 84, position: "C" },
                { name: "Paolo Banchero", rating: 84, position: "PF" },
                { name: "Julius Randle", rating: 83, position: "PF" },
                { name: "Scottie Barnes", rating: 83, position: "SF" },
                { name: "Franz Wagner", rating: 83, position: "SF" },
                { name: "Cade Cunningham", rating: 82, position: "PG" },
                { name: "Jalen Williams", rating: 82, position: "SF" },
                { name: "Alperen Şengün", rating: 82, position: "C" },
                { name: "Darius Garland", rating: 81, position: "PG" },
                { name: "Evan Mobley", rating: 81, position: "PF/C" },
                { name: "Jrue Holiday", rating: 80, position: "PG" },
                { name: "Kristaps Porziņģis", rating: 80, position: "PF/C" },
                { name: "Rudy Gobert", rating: 80, position: "C" },
                { name: "Mikal Bridges", rating: 79, position: "SF" },
                { name: "Fred VanVleet", rating: 79, position: "PG" },
                { name: "OG Anunoby", rating: 78, position: "SF" },
                { name: "Aaron Gordon", rating: 78, position: "PF" },
                { name: "Michael Porter Jr.", rating: 78, position: "SF" },
                { name: "Derrick White", rating: 77, position: "SG" },
                { name: "Brook Lopez", rating: 77, position: "C" },
                { name: "Zaccharie Risacher", rating: 77, position: "SF" },
                { name: "Jarrett Allen", rating: 76, position: "C" },
                { name: "Myles Turner", rating: 76, position: "C" },
                { name: "Alex Sarr", rating: 76, position: "C" },
                { name: "Jaden McDaniels", rating: 75, position: "SF" },
                { name: "Austin Reaves", rating: 75, position: "SG" },
                { name: "Reed Sheppard", rating: 75, position: "SG" },
                { name: "Stephon Castle", rating: 75, position: "PG" },
                { name: "Donovan Clingan", rating: 74, position: "C" },
                { name: "Matas Buzelis", rating: 74, position: "SF" },
                { name: "Chris Paul", rating: 78, position: "PG" },
                { name: "James Harden", rating: 84, position: "PG" },
                { name: "Russell Westbrook", rating: 79, position: "PG" },
                { name: "Klay Thompson", rating: 78, position: "SG" },
                { name: "Draymond Green", rating: 77, position: "PF" },
                { name: "Andrew Wiggins", rating: 76, position: "SF" },
                { name: "Zach LaVine", rating: 83, position: "SG" },
                { name: "DeMar DeRozan", rating: 82, position: "SG/SF" },
                { name: "Nikola Vucevic", rating: 80, position: "C" },
                { name: "Tobias Harris", rating: 77, position: "PF" },
                { name: "Kyle Kuzma", rating: 80, position: "PF" },
                { name: "Jordan Poole", rating: 76, position: "SG" },
                { name: "CJ McCollum", rating: 81, position: "SG" },
                { name: "Brandon Ingram", rating: 84, position: "SF" },
                { name: "Herb Jones", rating: 75, position: "SF" },
                { name: "Jaren Jackson Jr.", rating: 83, position: "PF/C" },
                { name: "Desmond Bane", rating: 83, position: "SG" },
                { name: "Marcus Smart", rating: 77, position: "PG" }
            ];

            // Manually pre-processed salary data from the user's provided list
            const playerSalariesData = [
                { name: "Stephen Curry", salary: 55.761216 },
                { name: "Joel Embiid", salary: 51.415938 },
                { name: "Nikola Jokic", salary: 51.415938 },
                { name: "Kevin Durant", salary: 51.179021 },
                { name: "Bradley Beal", salary: 50.203930 },
                { name: "Jaylen Brown", salary: 49.205800 },
                { name: "Devin Booker", salary: 49.205800 },
                { name: "Karl-Anthony Towns", salary: 49.205800 },
                { name: "Paul George", salary: 49.205800 },
                { name: "Kawhi Leonard", salary: 49.205800 },
                { name: "Jimmy Butler", salary: 48.798677 },
                { name: "Giannis Antetokounmpo", salary: 48.787676 },
                { name: "Damian Lillard", salary: 48.787676 },
                { name: "LeBron James", salary: 48.728845 },
                { name: "Zach LaVine", salary: 44.531940 },
                { name: "Rudy Gobert", salary: 43.827586 },
                { name: "Anthony Davis", salary: 43.219440 },
                { name: "Luka Dončić", salary: 43.031940 },
                { name: "Trae Young", salary: 43.031940 },
                { name: "Fred VanVleet", salary: 42.846615 },
                { name: "Anthony Edwards", salary: 42.176400 },
                { name: "Tyrese Haliburton", salary: 42.176400 },
                { name: "Lauri Markkanen", salary: 42.176400 },
                { name: "Pascal Siakam", salary: 42.176400 },
                { name: "Kyrie Irving", salary: 41.000000 },
                { name: "Domantas Sabonis", salary: 40.500000 },
                { name: "Ben Simmons", salary: 40.011909 },
                { name: "Zion Williamson", salary: 36.725670 },
                { name: "Ja Morant", salary: 36.725670 },
                { name: "Darius Garland", salary: 36.725670 },
                { name: "OG Anunoby", salary: 36.637932 },
                { name: "Jamal Murray", salary: 36.016200 },
                { name: "Brandon Ingram", salary: 36.016200 },
                { name: "Shai Gilgeous-Alexander", salary: 35.859950 },
                { name: "Michael Porter Jr.", salary: 35.859950 },
                { name: "Donovan Mitchell", salary: 35.410310 },
                { name: "Tyrese Maxey", salary: 35.147000 },
                { name: "LaMelo Ball", salary: 35.147000 },
                { name: "Jayson Tatum", salary: 34.848340 },
                { name: "Bam Adebayo", salary: 34.848340 },
                { name: "De'Aaron Fox", salary: 34.848340 },
                { name: "Desmond Bane", salary: 34.005250 },
                { name: "Deandre Ayton", salary: 34.005126 },
                { name: "James Harden", salary: 33.653846 },
                { name: "CJ McCollum", salary: 33.333333 },
                { name: "Julius Randle", salary: 33.073920 },
                { name: "Immanuel Quickley", salary: 32.500000 },
                { name: "Khris Middleton", salary: 31.000000 },
                { name: "Jrue Holiday", salary: 30.000000 },
                { name: "Isaiah Hartenstein", salary: 30.000000 },
                { name: "Jerami Grant", salary: 29.793104 },
                { name: "Jordan Poole", salary: 29.651786 },
                { name: "Dejounte Murray", salary: 29.517135 },
                { name: "Devin Vassell", salary: 29.347826 },
                { name: "Kristaps Porziņģis", salary: 29.268293 },
                { name: "Tyler Herro", salary: 29.000000 },
                { name: "Nic Claxton", salary: 27.556817 },
                { name: "Miles Bridges", salary: 27.173913 },
                { name: "John Collins", salary: 26.580000 },
                { name: "Andrew Wiggins", salary: 26.276786 },
                { name: "Anfernee Simons", salary: 25.892857 },
                { name: "RJ Barrett", salary: 25.794643 },
                { name: "Tobias Harris", salary: 25.365854 },
                { name: "Jaren Jackson Jr.", salary: 25.257798 },
                { name: "Jonathan Isaac", salary: 25.000000 },
                { name: "Jalen Brunson", salary: 24.960001 },
                { name: "Terry Rozier", salary: 24.924126 },
                { name: "Kyle Kuzma", salary: 24.456061 },
                { name: "Draymond Green", salary: 24.107143 },
                { name: "DeMar DeRozan", salary: 23.400000 },
                { name: "Mikal Bridges", salary: 23.300000 },
                { name: "Jaden McDaniels", salary: 23.017242 },
                { name: "Bruce Brown", salary: 23.000000 },
                { name: "Brook Lopez", salary: 23.000000 },
                { name: "Aaron Gordon", salary: 22.841455 },
                { name: "Kentavious Caldwell-Pope", salary: 22.757000 },
                { name: "Cameron Johnson", salary: 22.500000 },
                { name: "Malcolm Brogdon", salary: 22.500000 },
                { name: "Clint Capela", salary: 22.265280 },
                { name: "Dillon Brooks", salary: 22.255493 },
                { name: "De'Andre Hunter", salary: 21.696429 },
                { name: "Lonzo Ball", salary: 21.395348 },
                { name: "Marcus Smart", salary: 20.210284 },
                { name: "Derrick White", salary: 20.071429 },
                { name: "Jarrett Allen", salary: 20.000000 },
                { name: "Nikola Vučević", salary: 20.000000 },
                { name: "Myles Turner", salary: 19.928500 },
                { name: "Jakob Poeltl", salary: 19.500000 },
                { name: "Duncan Robinson", salary: 19.406000 },
                { name: "Norman Powell", salary: 19.241379 },
                { name: "Bojan Bogdanović", salary: 19.032850 },
                { name: "Keldon Johnson", salary: 19.000000 },
                { name: "D'Angelo Russell", salary: 18.692307 },
                { name: "Collin Sexton", salary: 18.350000 },
                { name: "Josh Hart", salary: 18.144000 },
                { name: "Jusuf Nurkić", salary: 18.125000 },
                { name: "Patrick Williams", salary: 18.000000 },
                { name: "Harrison Barnes", salary: 18.000000 },
                { name: "Malik Monk", salary: 17.405203 },
                { name: "Bogdan Bogdanović", salary: 17.260000 },
                { name: "Rui Hachimura", salary: 17.000000 },
                { name: "Kevin Huerter", salary: 16.830357 },
                { name: "Zach Collins", salary: 16.741200 },
                { name: "Caris LeVert", salary: 16.615384 },
                { name: "Luguentz Dort", salary: 16.500000 },
                { name: "Tim Hardaway Jr.", salary: 16.193183 },
                { name: "Klay Thompson", salary: 15.873016 },
                { name: "Deni Avdija", salary: 15.625000 },
                { name: "Grayson Allen", salary: 15.625000 },
                { name: "P.J. Washington", salary: 15.500000 },
                { name: "Max Strus", salary: 15.212068 },
                { name: "Isaiah Stewart", salary: 15.000000 },
                { name: "Dorian Finney-Smith", salary: 14.924167 },
                { name: "Mitchell Robinson", salary: 14.318182 },
                { name: "Jordan Clarkson", salary: 14.092577 },
                { name: "Onyeka Okongwu", salary: 14.000000 },
                { name: "Naz Reid", salary: 13.986432 },
                { name: "Cade Cunningham", salary: 13.940809 },
                { name: "Daniel Gafford", salary: 13.394160 },
                { name: "Grant Williams", salary: 13.025250 },
                { name: "Dennis Schröder", salary: 13.025250 },
                { name: "Isaiah Joe", salary: 12.991650 },
                { name: "Herbert Jones", salary: 12.976362 },
                { name: "Austin Reaves", salary: 12.976362 },
                { name: "Obi Toppin", salary: 12.975000 },
                { name: "Cole Anthony", salary: 12.900000 },
                { name: "De'Anthony Melton", salary: 12.822000 },
                { name: "Kelly Olynyk", salary: 12.804878 },
                { name: "Victor Wembanyama", salary: 12.768960 },
                { name: "Josh Green", salary: 12.654321 },
                { name: "Richaun Holmes", salary: 12.648321 },
                { name: "Steven Adams", salary: 12.600000 },
                { name: "Bobby Portis", salary: 12.578286 },
                { name: "Zaccharie Risacher", salary: 12.569040 },
                { name: "Brandon Clarke", salary: 12.500000 },
                { name: "Marvin Bagley III", salary: 12.500000 },
                { name: "Jalen Green", salary: 12.483048 },
                { name: "Robert Williams", salary: 12.428571 },
                { name: "Paolo Banchero", salary: 12.160800 },
                { name: "Coby White", salary: 12.000000 },
                { name: "Wendell Carter Jr.", salary: 11.950000 },
                { name: "Ivica Zubac", salary: 11.743210 },
                { name: "P.J. Tucker", salary: 12.025777 },
                { name: "Donte DiVincenzo", salary: 11.445000 },
                { name: "Brandon Miller", salary: 11.424600 },
                { name: "Terance Mann", salary: 11.423077 },
                { name: "Alex Sarr", salary: 11.245680 },
                { name: "Evan Mobley", salary: 11.227657 },
                { name: "Larry Nance Jr.", salary: 11.205000 },
                { name: "Matisse Thybulle", salary: 11.025000 }
            ];

            // Create a map for quick salary lookup by player name
            const customSalaryMap = new Map();
            playerSalariesData.forEach(p => {
                customSalaryMap.set(p.name, p.salary);
            });

            // Update the existing 'players' array with the custom salaries
            players = players.map(player => {
                const customSalary = customSalaryMap.get(player.name);
                if (customSalary !== undefined) {
                    return { ...player, salary: customSalary };
                } else {
                    // Assign a reasonable default salary for players not in the provided list
                    // (e.g., lower tier salaries for unlisted players to prevent them from being too cheap)
                    return { ...player, salary: Math.floor(Math.random() * (7 - 2 + 1)) + 2 }; // 2-7M default
                }
            });


            // List of all 30 NBA teams with their logo URLs
            const nbaTeams = [
                { name: "Atlanta Hawks", initials: "ATL", logoUrl: "https://upload.wikimedia.org/wikipedia/en/2/24/Atlanta_Hawks_logo.svg" },
                { name: "Boston Celtics", initials: "BOS", logoUrl: "https://upload.wikimedia.org/wikipedia/en/8/8f/Boston_Celtics.svg" },
                { name: "Brooklyn Nets", initials: "BKN", logoUrl: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Brooklyn_Nets_Logo.svg/512px-Brooklyn_Nets_Logo.svg.png" },
                { name: "Charlotte Hornets", initials: "CHA", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/c/c4/Charlotte_Hornets_%282014%29.svg/512px-Charlotte_Hornets_%282014%29.svg.png" },
                { name: "Chicago Bulls", initials: "CHI", logoUrl: "https://upload.wikimedia.org/wikipedia/en/6/67/Chicago_Bulls_logo.svg" },
                { name: "Cleveland Cavaliers", initials: "CLE", logoUrl: "https://upload.wikimedia.org/wikipedia/en/4/4b/Cleveland_Cavaliers_logo.svg" },
                { name: "Dallas Mavericks", initials: "DAL", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/9/97/Dallas_Mavericks_logo.svg/512px-Dallas_Mavericks_logo.svg.png" },
                { name: "Denver Nuggets", initials: "DEN", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/7/76/Denver_Nuggets_logo.svg/512px-Denver_Nuggets_logo.svg.png" },
                { name: "Detroit Pistons", initials: "DET", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/c/c9/Detroit_Pistons_logo.svg/512px-Detroit_Pistons_logo.svg.png" },
                { name: "Golden State Warriors", initials: "GSW", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/0/01/Golden_State_Warriors_logo.svg/512px-Golden_State_Warriors_logo.svg.png" },
                { name: "Houston Rockets", initials: "HOU", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/2/28/Houston_Rockets.svg/512px-Houston_Rockets.svg.png" },
                { name: "Indiana Pacers", initials: "IND", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/1/1e/Indiana_Pacers_logo.svg/512px-Indiana_Pacers_logo.svg.png" },
                { name: "Los Angeles Clippers", initials: "LAC", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/b/bb/Los_Angeles_Clippers_logo.svg/512px-Los_Angeles_Clippers_logo.svg.png" },
                { name: "Los Angeles Lakers", initials: "LAL", logoUrl: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3c/Los_Angeles_Lakers_logo.svg/512px-Los_Angeles_Lakers_logo.svg.png" },
                { name: "Memphis Grizzlies", initials: "MEM", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/f/f1/Memphis_Grizzlies.svg/512px-Memphis_Grizzlies.svg.png" },
                { name: "Miami Heat", initials: "MIA", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/f/f6/Miami_Heat_logo.svg/512px-Miami_Heat_logo.svg.png" },
                { name: "Milwaukee Bucks", initials: "MIL", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/4/44/Milwaukee_Bucks_logo.svg/512px-Milwaukee_Bucks_logo.svg.png" },
                { name: "Minnesota Timberwolves", initials: "MIN", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/d/d9/Minnesota_Timberwolves_logo.svg/512px-Minnesota_Timberwolves_logo.svg.png" },
                { name: "New Orleans Pelicans", initials: "NOP", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/0/0d/New_Orleans_Pelicans_logo.svg/512px-New_Orleans_Pelicans_logo.svg.png" },
                { name: "New York Knicks", initials: "NYK", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/2/25/New_York_Knicks_logo.svg/512px-New_York_Knicks_logo.svg.png" },
                { name: "Oklahoma City Thunder", initials: "OKC", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/5/5d/Oklahoma_City_Thunder.svg/512px-Oklahoma_City_Thunder.svg.png" },
                { name: "Orlando Magic", initials: "ORL", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/1/10/Orlando_Magic_logo.svg/512px-Orlando_Magic_logo.svg.png" },
                { name: "Philadelphia 76ers", initials: "PHI", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/0/0e/Philadelphia_76ers_logo.svg/512px-Philadelphia_76ers_logo.svg.png" },
                { name: "Phoenix Suns", initials: "PHX", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/5/57/Phoenix_Suns_logo.svg/512px-Phoenix_Suns_logo.svg.png" },
                { name: "Portland Trail Blazers", initials: "POR", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/2/21/Portland_Trail_Blazers_logo.svg/512px-Portland_Trail_Blazers_logo.svg.png" },
                { name: "Sacramento Kings", initials: "SAC", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/c/c7/Sacramento_Kings_logo.svg/512px-Sacramento_Kings_logo.svg.png" },
                { name: "San Antonio Spurs", initials: "SAS", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/a/a2/San_Antonio_Spurs.svg/512px-San_Antonio_Spurs.svg.png" },
                { name: "Toronto Raptors", initials: "TOR", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/3/36/Toronto_Raptors_logo.svg/512px-Toronto_Raptors_logo.svg.png" },
                { name: "Utah Jazz", initials: "UTA", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/0/04/Utah_Jazz_logo_%282016%29.svg/512px-Utah_Jazz_logo_%282016%29.svg.png" },
                { name: "Washington Wizards", initials: "WAS", logoUrl: "https://upload.wikimedia.org/wikipedia/en/thumb/0/02/Washington_Wizards_logo.svg/512px-Washington_Wizards_logo.svg.png" }
            ];


            // Get DOM elements
            const playerPoolEl = document.getElementById('player-pool');
            const yourTeamEl = document.getElementById('your-team');
            const simSeasonBtn = document.getElementById('sim-season-btn');
            const simPlayoffsBtn = document.getElementById('sim-playoffs-btn');
            const resetBtn = document.getElementById('reset-btn');
            const resultsDisplay = document.getElementById('results-display');
            const confettiContainer = document.getElementById('confetti-container');
            const teamCountEl = document.getElementById('team-count');
            const playerCountEl = document.getElementById('player-count');
            const draftHeaderEl = document.getElementById('draft-header');
            const positionLabelEl = document.getElementById('position-label');
            const startBtn = document.getElementById('start-btn');
            const startScreen = document.getElementById('start-screen');
            const gameContainer = document.getElementById('game-container');
            const teamSelectionScreen = document.getElementById('team-selection-screen'); // New
            const teamLogosContainer = document.getElementById('team-logos-container'); // New
            const yourTeamNameEl = document.getElementById('your-team-name'); // New
            const botDraftedPlayersEl = document.getElementById('bot-drafted-players'); // New element for bot picks
            const botDraftedHeaderEl = document.getElementById('bot-drafted-header'); // New element for bot drafted section header
            const botDraftedSectionEl = document.getElementById('bot-drafted-section'); // NEW: Reference to the entire bot drafted section
            const capSpaceEl = document.getElementById('cap-space'); // NEW: Element to display cap space

            // Modal elements
            const customModal = document.getElementById('custom-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalMessage = document.getElementById('modal-message');
            const modalCloseBtn = document.getElementById('modal-close-btn');

            let yourTeam = []; // Array to hold drafted players
            let selectedTeamName = ''; // Variable to store the chosen NBA team name
            let draftedPlayers = []; // NEW: Array to hold all players drafted by bots
            let currentCapSpace = STARTING_CAP_SPACE; // NEW: Initialize current cap space

            // Event listener for modal close button
            modalCloseBtn.addEventListener('click', () => {
                hideModal();
            });

            /**
             * Shows the custom modal with a given title and message.
             * @param {string} title - The title for the modal.
             * @param {string} message - The message content for the modal.
             */
            function showModal(title, message) {
                modalTitle.textContent = title;
                modalMessage.textContent = message;
                customModal.classList.add('show');
            }

            /**
             * Hides the custom modal.
             */
            function hideModal() {
                customModal.classList.remove('show');
            }

            /**
             * Shuffles an array in place.
             * @param {Array} array - The array to shuffle.
             */
            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            /**
             * Generates a random hexadecimal color code.
             * This function is now mostly for the fallback background if a logo doesn't load.
             * @returns {string} A 6-character hexadecimal color string.
             */
            function getRandomColor() {
                const letters = '0123456789ABCDEF';
                let color = '';
                for (let i = 0; i < 6; i++) {
                    color += letters[Math.floor(Math.random() * 16)];
                }
                return color;
            }

            /**
             * Creates and appends team logo cards to the team selection screen.
             */
            function renderTeams() {
                teamLogosContainer.innerHTML = ''; // Clear previous logos
                nbaTeams.forEach(team => {
                    const teamCard = document.createElement('div');
                    // Use the actual logoUrl, with a fallback to a generic NBA placeholder if the image fails
                    const imageUrl = team.logoUrl;
                    // Updated fallback: Use team initials as text
                    const fallbackImageUrl = `https://placehold.co/100x100/333333/ffffff?text=${team.initials}`;
                    teamCard.className = 'flex flex-col items-center p-3 bg-white rounded-lg shadow-md cursor-pointer hover:bg-gray-200 transition-colors duration-200 border border-blue-200';
                    teamCard.innerHTML = `
                        <img src="${imageUrl}" alt="${team.name} Logo" class="w-20 h-20 sm:w-24 sm:h-24 md:w-28 md:h-28 rounded-full mb-2 object-contain" onerror="this.onerror=null;this.src='${fallbackImageUrl}'; this.style.backgroundColor = '#333333';">
                        <p class="text-sm sm:text-base font-semibold text-center text-blue-700">${team.name}</p>
                    `;
                    teamCard.addEventListener('click', () => selectTeam(team.name));
                    teamLogosContainer.appendChild(teamCard);
                });
            }

            /**
             * Handles team selection, updates UI, and transitions to the game screen.
             * @param {string} teamName - The name of the selected team.
             */
            function selectTeam(teamName) {
                selectedTeamName = teamName;
                yourTeamNameEl.textContent = selectedTeamName; // Display the selected team name
                currentCapSpace = STARTING_CAP_SPACE; // Reset cap space for a new game
                capSpaceEl.textContent = currentCapSpace.toFixed(1); // Update cap space display
                teamSelectionScreen.classList.add('hidden'); // Hide team selection
                teamSelectionScreen.classList.remove('flex'); // Remove flex for proper hiding
                gameContainer.classList.remove('hidden'); // Show game container
                simulateBotDraft(); // NEW: Simulate bot drafts before user's turn
                renderPlayers(); // Render players for drafting
            }

            // Event listener for the initial "Start Game" button
            startBtn.addEventListener('click', () => {
                startScreen.style.display = 'none'; // Hide start screen
                teamSelectionScreen.classList.remove('hidden'); // Show team selection screen
                teamSelectionScreen.classList.add('flex'); // Add flex for proper display
                renderTeams(); // Populate team logos
            });

            /**
             * Creates an HTML card for a player.
             * @param {object} player - The player object.
             * @param {boolean} inTeam - True if the player is in the user's team, false otherwise.
             * @returns {HTMLElement} The player card div element.
             */
            function createPlayerCard(player, inTeam) {
                const card = document.createElement('div');
                card.className = 'bg-white p-3 rounded-lg flex justify-between items-center mb-2 shadow-md hover:bg-gray-100 transition-colors duration-200 border border-blue-200';
                card.innerHTML = `
                    <div>
                        <p class="font-semibold text-lg text-gray-800">${player.name}</p>
                        <p class="text-sm text-gray-600">POS: ${player.position}</p>
                        <p class="text-lg font-bold text-blue-500">SAL: $${player.salary.toFixed(2)}M</p> <!-- NEW: Display salary with 2 decimal places, larger font, blue color -->
                    </div>
                    <div class="text-right">
                        <p class="font-bold text-xl text-red-500">${player.rating}</p>
                        <button class="draft-btn mt-1 text-sm ${inTeam ? 'bg-red-600 hover:bg-red-700' : 'bg-blue-600 hover:bg-blue-700'} text-white rounded transition duration-300 shadow-sm player-card-button">${inTeam ? 'Remove' : 'Draft'}</button>
                    </div>
                `;
                // Add event listener to the draft/remove button
                const draftButton = card.querySelector('.draft-btn');
                draftButton.addEventListener('click', (e) => {
                    e.stopPropagation(); // Prevent card click event if any
                    if (inTeam) {
                        removePlayerFromTeam(player);
                    } else {
                        draftPlayer(player);
                    }
                });

                // NEW: Disable button if team is full OR if not enough cap space
                if (yourTeam.length === TEAM_SIZE || (!inTeam && player.salary > currentCapSpace)) {
                    draftButton.disabled = true;
                } else if (inTeam && yourTeam.length === TEAM_SIZE) { // If player is in team and team is full, allow remove (for now, will be disabled globally)
                    // This case is implicitly handled by the global disable
                }

                return card;
            }

            // NEW: Function to create a read-only player card for bot drafted players
            function createBotDraftedPlayerCard(player) {
                const card = document.createElement('div');
                card.className = 'bg-gray-300 p-3 rounded-lg flex justify-between items-center shadow-md border border-blue-200'; /* Adjusted color */
                card.innerHTML = `
                    <div>
                        <p class="font-semibold text-lg text-gray-800">${player.name}</p>
                        <p class="text-sm text-gray-600">POS: ${player.position}</p>
                        <p class="text-lg font-bold text-blue-500">SAL: $${player.salary.toFixed(2)}M</p> <!-- Display salary -->
                    </div>
                    <div class="text-right">
                        <p class="font-bold text-xl text-red-500">${player.rating}</p>
                        <p class="text-xs text-gray-700 mt-1">Drafted by AI</p>
                    </div>
                `;
                return card;
            }

            /**
             * Simulates other bot teams drafting players.
             * Bots will draft based on position need and player rating, with more randomness.
             */
            function simulateBotDraft() {
                // Get all players and make a copy to work with, excluding those already drafted by the user in a previous session
                let availablePlayersForBots = players.filter(p => !yourTeam.some(teamPlayer => teamPlayer.name === p.name));
                draftedPlayers = []; // Reset drafted players

                // Shuffle the entire player pool once to randomize pick order for bots
                shuffleArray(availablePlayersForBots);

                // Simulate each bot team drafting their full roster
                for (let i = 0; i < NUM_BOT_TEAMS; i++) {
                    const botTeamRoster = []; // Roster for current bot team
                    // A bot team's cap space (for more realistic bot drafting, though not strictly required by prompt)
                    let botCapSpace = STARTING_CAP_SPACE;

                    // Keep track of positions needed for this bot team
                    let positionsNeeded = [...DRAFT_ORDER.map(d => d.position)];
                    shuffleArray(positionsNeeded); // Randomize the order bots seek positions

                    // Loop until the bot team has a player for each position or runs out of players
                    for(let k = 0; k < TEAM_SIZE && availablePlayersForBots.length > 0; k++) { // Draft 5 players per bot team
                        let playerToDraft = null;
                        let eligiblePlayersForCurrentPos = [];
                        let foundPlayer = false;

                        // Try to find a player for a needed position with available cap
                        for (const targetPosition of positionsNeeded) {
                            eligiblePlayersForCurrentPos = availablePlayersForBots
                                .filter(p => p.position.split('/').includes(targetPosition) && p.salary <= botCapSpace)
                                .sort((a, b) => b.rating - a.rating); // Still sort by rating for a slight preference

                            if (eligiblePlayersForCurrentPos.length > 0) {
                                const pickRange = Math.min(eligiblePlayersForCurrentPos.length, 7); // Pick from top 7, for example
                                const pickIndex = Math.floor(Math.random() * pickRange);
                                playerToDraft = eligiblePlayersForCurrentPos[pickIndex];
                                foundPlayer = true;
                                positionsNeeded = positionsNeeded.filter(pos => pos !== targetPosition); // Remove this position from needed list
                                break; // Found a player for a needed position, move to next bot pick
                            }
                        }

                        // If no specific position player was picked (or couldn't be afforded for a needed position),
                        // try to pick any high-rated available player with available cap
                        if (!foundPlayer && availablePlayersForBots.length > 0) {
                            const sortedRemainingPlayers = availablePlayersForBots
                                .filter(p => p.salary <= botCapSpace)
                                .sort((a, b) => b.rating - a.rating);

                            if (sortedRemainingPlayers.length > 0) {
                                const pickRange = Math.min(sortedRemainingPlayers.length, 10); // Pick from top 10 general players
                                const pickIndex = Math.floor(Math.random() * pickRange);
                                playerToDraft = sortedRemainingPlayers[pickIndex];
                                foundPlayer = true;

                                // Remove any position fulfilled by this general pick from positionsNeeded
                                if (playerToDraft) {
                                    positionsNeeded = positionsNeeded.filter(pos => !playerToDraft.position.split('/').includes(pos));
                                }
                            }
                        }

                        if (playerToDraft) {
                            botTeamRoster.push(playerToDraft);
                            draftedPlayers.push(playerToDraft);
                            botCapSpace -= playerToDraft.salary;
                            availablePlayersForBots = availablePlayersForBots.filter(p => p.name !== playerToDraft.name);
                        } else {
                            // If no player could be drafted for this bot team in this pick, break
                            // This bot team might not fill all 5 spots if choices are too limited
                            break;
                        }
                    }
                }
            }


            /**
             * Renders the players drafted by other bots, filtered by the current drafting position.
             * @param {string} currentPosition - The position currently being drafted by the user.
             * @param {string} currentLabel - The label for the current position (e.g., "Point Guards").
             */
            function renderBotDraftedPlayers(currentPosition, currentLabel) {
                botDraftedPlayersEl.innerHTML = '';
                botDraftedHeaderEl.textContent = `Other Teams' Drafted ${currentLabel}`; // Dynamic header

                const relevantBotDraftedPlayers = draftedPlayers
                    .filter(p => p.position.split('/').includes(currentPosition))
                    .sort((a, b) => b.rating - a.rating); // Sort by rating for display

                if (relevantBotDraftedPlayers.length > 0) {
                    relevantBotDraftedPlayers.forEach(p => {
                        botDraftedPlayersEl.appendChild(createBotDraftedPlayerCard(p));
                    });
                } else {
                    botDraftedPlayersEl.innerHTML = `<p class="text-center text-gray-500">No ${currentLabel} have been drafted by other teams yet.</p>`;
                }
            }


            /**
             * Renders players in the player pool and the user's team.
             * Updates counts and button states.
             */
            function renderPlayers() {
                playerPoolEl.innerHTML = ''; // Clear player pool display
                yourTeamEl.innerHTML = ''; // Clear your team display
                capSpaceEl.textContent = currentCapSpace.toFixed(1); // Update cap space display

                // Determine the current required position for drafting
                const currentPositionInfo = DRAFT_ORDER[yourTeam.length];
                const currentPosition = currentPositionInfo?.position;
                const currentLabel = currentPositionInfo?.label || "Players";

                // Filter available players: not in your team AND not drafted by bots AND match the current required position
                // Also, filter by cap space
                const availablePlayers = players
                    .filter(p => !yourTeam.some(teamPlayer => teamPlayer.name === p.name))
                    .filter(p => !draftedPlayers.some(botPlayer => botPlayer.name === p.name)) // Filter out bot drafted players
                    .filter(p => currentPosition ? p.position.split('/').includes(currentPosition) : true)
                    .sort((a, b) => b.rating - a.rating); // Sort by rating descending

                // Append player cards to the player pool
                availablePlayers.forEach(p => {
                    const card = createPlayerCard(p, false);
                    const draftButton = card.querySelector('.draft-btn');
                    // Disable draft button if not enough cap or if team is full
                    if (p.salary > currentCapSpace || yourTeam.length === TEAM_SIZE) {
                        draftButton.disabled = true;
                    }
                    playerPoolEl.appendChild(card);
                });

                // Append player cards to your team, sorted by rating
                yourTeam.sort((a, b) => b.rating - a.rating).forEach(p => {
                    const card = createPlayerCard(p, true);
                    const removeButton = card.querySelector('.draft-btn'); // This is the 'remove' button
                    // Disable remove button if team is full AND simulation hasn't started
                    if (yourTeam.length === TEAM_SIZE && simSeasonBtn.style.display !== 'none') {
                        removeButton.disabled = true;
                    }
                    yourTeamEl.appendChild(card);
                });

                // Update UI elements
                teamCountEl.textContent = `${yourTeam.length}`; // Number of players in your team
                playerCountEl.textContent = `${availablePlayers.length}`; // Number of available players
                positionLabelEl.textContent = currentLabel; // Current position being drafted

                // Enable simulate season button only when team is full
                const isTeamFull = yourTeam.length === TEAM_SIZE;
                simSeasonBtn.disabled = !isTeamFull;

                // Update draft header text based on draft progress
                draftHeaderEl.textContent = yourTeam.length < TEAM_SIZE ? `Draft ${currentPositionInfo.label.slice(0, -1)}` : 'NBA Draft & Season Simulator';

                // NEW: Hide bot drafted section if team is full
                if (isTeamFull) {
                    botDraftedSectionEl.classList.add('hidden');
                } else {
                    botDraftedSectionEl.classList.remove('hidden');
                    // Call renderBotDraftedPlayers with current position info
                    renderBotDraftedPlayers(currentPosition, currentLabel);
                }
            }

            /**
             * Adds a player to the user's team.
             * @param {object} player - The player object to draft.
             */
            function draftPlayer(player) {
                if (yourTeam.length >= TEAM_SIZE) {
                    resultsDisplay.textContent = "Your team is full! Remove a player to draft another.";
                    return;
                }
                if (player.salary > currentCapSpace) {
                    showModal("Insufficient Cap Space!", `You need $${player.salary.toFixed(2)}M to draft ${player.name}, but you only have $${currentCapSpace.toFixed(1)}M remaining.`);
                    return;
                }

                const currentPositionInfo = DRAFT_ORDER[yourTeam.length];
                const currentPosition = currentPositionInfo.position;
                // Check if the player's position matches the required draft position
                if (!player.position.split('/').includes(currentPosition)) {
                    resultsDisplay.textContent = `Please draft a ${currentPositionInfo.label.slice(0, -1)}.`;
                    return;
                }
                yourTeam.push(player); // Add player to team
                currentCapSpace -= player.salary; // Deduct salary
                renderPlayers(); // Re-render displays
                resultsDisplay.textContent = `You drafted ${player.name} as your ${currentPositionInfo.label.slice(0, -1)}. Remaining Cap: $${currentCapSpace.toFixed(1)}M.`; // Update status message
            }

            /**
             * Removes a player from the user's team.
             * @param {object} player - The player object to remove.
             */
            function removePlayerFromTeam(player) {
                // Prevent removal if team is already full and the season simulation hasn't happened.
                if (yourTeam.length === TEAM_SIZE && simSeasonBtn.style.display !== 'none') {
                     resultsDisplay.textContent = "You cannot remove players once your team is complete for drafting.";
                     return;
                }
                yourTeam = yourTeam.filter(p => p.name !== player.name); // Filter out the player
                currentCapSpace += player.salary; // Add salary back
                renderPlayers(); // Re-render displays
                resultsDisplay.textContent = `Removed ${player.name} from your team. Remaining Cap: $${currentCapSpace.toFixed(1)}M.`; // Update status message
            }

            // Event listener for "Simulate Season" button
            simSeasonBtn.addEventListener('click', () => {
                const totalRating = yourTeam.reduce((acc, p) => acc + p.rating, 0); // Sum of all player ratings
                const avgRating = totalRating / TEAM_SIZE; // Average team rating
                const baseWins = 10; // Base wins for a very low-rated team
                const winsPerRatingPoint = 0.9; // How many wins per rating point above 80
                // Calculate wins based on average rating, scaled by team size
                let wins = Math.round(baseWins + (avgRating - 80) * winsPerRatingPoint * (TEAM_SIZE / 2));
                // Add some randomness to wins
                wins += Math.floor(Math.random() * 15) - 7; // +/- 7 wins randomly
                wins = Math.max(0, Math.min(82, wins)); // Cap wins between 0 and 82 (total games in NBA season)
                const losses = 82 - wins; // Calculate losses

                resultsDisplay.innerHTML = `
                    <p class="text-xl font-bold text-green-600">Regular Season Finished!</p>
                    <p>Your team's record: <span class="text-green-600">${wins}</span> - <span class="text-red-600">${losses}</span></p>
                `;
                // Check if the team made the playoffs
                if (wins >= PLAYOFF_WIN_THRESHOLD) {
                    resultsDisplay.innerHTML += '<p class="text-blue-500 mt-2">Congratulations, you made the playoffs!</p>';
                    simPlayoffsBtn.style.display = 'inline-block'; // Show playoffs button
                } else {
                    resultsDisplay.innerHTML += '<p class="text-gray-600 mt-2">You missed the playoffs. Better luck next year!</p>';
                }
                simSeasonBtn.style.display = 'none'; // Hide season button
                resetBtn.style.display = 'inline-block'; // Show reset button
                // Store wins for playoff simulation
                simSeasonBtn.dataset.regularSeasonWins = wins;
            });

            /**
             * Simulates the playoff rounds based on team's average rating and regular season wins.
             * @param {number} avgRating - The average rating of the user's team.
             * @param {number} regularSeasonWins - The number of wins the user's team achieved in the regular season.
             * @returns {object} An object indicating if the team won the championship or was eliminated.
             */
            function simulatePlayoffs(avgRating, regularSeasonWins) {
                // Base opponent ratings for each round, adjusted for randomness
                const baseOpponentRatings = [
                    83, // First Round (lower rated playoff team)
                    88, // Conference Semifinals
                    92, // Conference Finals
                    96  // NBA Finals (top team)
                ];

                for (let i = 0; i < baseOpponentRatings.length; i++) {
                    const roundName = ["First Round", "Conference Semifinals", "Conference Finals", "NBA Finals"][i];
                    let opponentRating = baseOpponentRatings[i];

                    // Adjust opponent rating based on user's regular season wins (simulating seeding)
                    // Higher wins means potentially facing a slightly weaker opponent in early rounds,
                    // or a stronger one later if the general talent pool is high.
                    // This creates a subtle advantage for better regular season teams.
                    const winAdvantage = (regularSeasonWins - PLAYOFF_WIN_THRESHOLD) / 5; // e.g., for every 5 wins above threshold, a slight edge
                    opponentRating -= winAdvantage * (0.5 + i * 0.1); // More impact in earlier rounds

                    // Add more significant randomness to opponent's actual rating for variety
                    opponentRating += (Math.random() * 10) - 5; // +/- 5 points randomness

                    // Ensure opponent rating stays within reasonable bounds
                    opponentRating = Math.max(70, Math.min(99, opponentRating));

                    const ratingDiff = avgRating - opponentRating; // Difference in rating

                    // Logistic function to determine win probability (higher ratingDiff = higher probability)
                    // The '0.1' factor controls the steepness of the win probability curve.
                    const probability = 1 / (1 + Math.exp(-0.1 * ratingDiff));

                    if (Math.random() < probability) {
                        continue; // Win the round, proceed to next
                    } else {
                        return { eliminatedIn: roundName }; // Lose the round, return elimination info
                    }
                }
                return { champion: true }; // Won all rounds, champion!
            }

            // Event listener for "Simulate Playoffs" button
            simPlayoffsBtn.addEventListener('click', () => {
                const totalRating = yourTeam.reduce((acc, p) => acc + p.rating, 0);
                const avgRating = totalRating / TEAM_SIZE;
                const regularSeasonWins = parseInt(simSeasonBtn.dataset.regularSeasonWins || 0); // Retrieve wins
                const playoffResult = simulatePlayoffs(avgRating, regularSeasonWins); // Pass wins to simulation

                if (playoffResult.champion) {
                    resultsDisplay.innerHTML = `
                        <p class="text-3xl font-bold text-blue-700 animate-pulse">🏆 CHAMPIONSHIP WON! 🏆</p>
                        <p class="mt-2 text-blue-600">Your team battled through the playoffs and emerged victorious!</p>
                    `;
                    triggerConfetti(); // Trigger confetti for championship win
                } else {
                    resultsDisplay.innerHTML = `
                        <p class="text-2xl font-bold text-red-600">Eliminated!</p>
                        <p class="mt-2 text-gray-700">Your team was eliminated in the ${playoffResult.eliminatedIn}. Better luck next season!</p>
                    `;
                }
                simPlayoffsBtn.style.display = 'none'; // Hide playoffs button
            });

            // Event listener for "Draft Again" button (reset game)
            resetBtn.addEventListener('click', () => {
                yourTeam = []; // Clear your team
                draftedPlayers = []; // Clear bot drafted players
                currentCapSpace = STARTING_CAP_SPACE; // Reset cap space
                resultsDisplay.textContent = 'Draft your 5-player team to begin!'; // Reset results message
                simPlayoffsBtn.style.display = 'none'; // Hide playoffs button
                simSeasonBtn.style.display = 'inline-block'; // Show season button
                resetBtn.style.display = 'none'; // Hide reset button
                // Go back to team selection or directly to draft after re-drafting bots
                teamSelectionScreen.classList.remove('hidden');
                teamSelectionScreen.classList.add('flex');
                gameContainer.classList.add('hidden');
                renderTeams();
            });

            /**
             * Triggers a confetti animation.
             */
            function triggerConfetti() {
                const colors = ['#EF4444', '#3B82F6', '#10B981', '#F59E0B', '#6366F1']; // Red, Blue, Green, Yellow, Indigo
                for (let i = 0; i < 100; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.left = `${Math.random() * 100}vw`;
                    confetti.style.top = `${-Math.random() * 20}px`; // Start slightly above the viewport
                    confetti.style.animationDelay = `${Math.random() * 0.5}s`; // Stagger animation
                    confetti.style.animationDuration = `${3 + Math.random() * 3}s`; // Random duration
                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`; // Initial random rotation
                    confettiContainer.appendChild(confetti);

                    // Remove confetti after animation to prevent DOM bloat
                    confetti.addEventListener('animationend', () => {
                        confetti.remove();
                    });
                }
            }
        });
    </script>
</body>
</html>
